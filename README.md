# MobileApp

## Описание
Это REST API для управления смартфонами, пользователями и заказами. Проект реализован на Spring Boot, использует базу данных MySQL через Spring Data JPA (Hibernate) и реализует in-memory кэширование. Также добавлены:
- Логирование действий и ошибок с использованием аспектов, с записью логов в файл.
- Полезный GET-запрос с параметрами, реализованный через кастомные запросы (@Query) в JPQL и native SQL для фильтрации данных по вложенной сущности.
- Документация API с помощью Swagger (OpenAPI 2.8.6).

---

## Выполненные задания
1. **Подключение БД (MySQL) и использование Hibernate/Spring Data JPA**  
   - Сущности: `Smartphone`, `Order`, `User`.  
   - Связи:  
     - `User` ↔ `Order` (один ко многим / многие к одному)  
     - `Order` ↔ `Smartphone` (многие ко многим через join‑таблицу `order_smartphone`)  
   - Настроены каскадные операции и ленивые/жадные загрузки.

2. **In-memory кэширование**  
   - Реализован отдельный бин для хранения данных (с ограниченным размером и политикой удаления наименее часто используемых элементов).  
   - При CRUD‑операциях кэш обновляется.

3. **Логирование действий и ошибок**  
   - Используются аспекты (AOP) для логирования входа/выхода из методов контроллеров, сервисов и репозиториев.  
   - Логи записываются в файл (например, `app.log`), путь и уровень задаются в `application.properties`.

4. **Запрос для получения лог-файла**  
   - Добавлен endpoint `/logs` (и `/logs/download`) для фильтрации и возврата логов за указанную дату.  
   - Можно получить содержимое лог-файла как текст или скачать файл.

5. **Кастомный GET запрос с фильтрацией по вложенной сущности**  
   - В `OrderRepository` реализованы два метода с @Query – один на JPQL и один с native SQL – для фильтрации заказов по `User.username`.

6. **Swagger (OpenAPI)**
   - Подключен модуль `springdoc-openapi-starter-webmvc-api` и `springdoc-openapi-starter-webmvc-ui` версии **2.8.6**.
   - Документация доступна по адресу:  
     `http://localhost:8081/swagger-ui/index.html`
   - Swagger позволяет просматривать и тестировать все endpoint’ы API, видеть их параметры и схемы ответов.

---

## Стек технологий
- Java 17
- Spring Boot (Web, Data JPA, Security*)
- Hibernate
- MySQL
- Maven
- MapStruct (для маппинга DTO)
- Spring AOP (для логирования)
- In-memory кэш
- OpenAPI/Swagger (springdoc-openapi 2.8.6)

\* Spring Security включён, но настроен для открытого доступа (см. `SecurityConfig`).

---

## Структура проекта

